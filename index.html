<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>2026 Super Bowl Squares</title>
  <style>
    :root {
      --cell-size: clamp(24px, 8.5vw, 48px);   /* square size – fits 11 columns + labels */
      --gap: 1px;
    }

    * { box-sizing: border-box; }

    body {
      font-family: Arial, Helvetica, sans-serif;
      background: #FF991C;
      margin: 0;
      padding: 12px 6px;
      text-align: center;
      -webkit-text-size-adjust: 100%;
      touch-action: manipulation;
    }
	
    h1 {
      color: #2c3e50;
      margin: 0 0 10px;
      font-size: clamp(1.3rem, 4.8vw, 1.7rem);
    }

    #controls, #info, #scoreDisplay, #quarterWinners, #status {
      text-align: center !important;
      margin-left: auto !important;
      margin-right: auto !important;
      display: block !important;
      max-width: 95%;
    }

    #controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 10px auto 18px;
    }

    #controls input, #controls button {
      padding: 9px 12px;
      font-size: clamp(0.9rem, 3.4vw, 1rem);
      border: 1px solid #bdc3c7;
      border-radius: 6px;
      width: 100%;
      max-width: 300px;
      margin: 0 auto;
    }
	


    #controls button {
      background: #27ae60;
      color: white;
      border: none;
      cursor: pointer;
    }

    #controls button:hover {
      background: #219a52;
    }

    #info, #status {
      font-size: clamp(0.8rem, 3vw, 0.9rem);
      color: #555;
      margin: 5px auto;
    }

    #scoreDisplay {
      font-size: clamp(1.15rem, 4.2vw, 1.4rem);
      font-weight: bold;
      margin: 8px auto;
      color: #2c3e50;
	  display: flex;
	  align-items: center; /* Centers vertically */
    }

    #quarterWinners {
      font-size: clamp(0.85rem, 3vw, 0.95rem);
      line-height: 1.4;
      margin: 10px auto;
      min-height: 36px;
    }

    table {
      margin: 0 auto;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 100%;
      table-layout: fixed;           /* critical: forces equal column widths */
    }

    th, td {
      border: 1px solid #bdc3c7;
      padding: 4px;
      text-align: center;
      font-size: clamp(0.72rem, 2.6vw, 0.85rem);
      width: var(--cell-size) !important;
      height: var(--cell-size) !important;
      min-width: var(--cell-size);
      max-width: var(--cell-size);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    @media (max-width: 480px) {
      th, td {
        white-space: normal;
        word-break: break-word;
        hyphens: auto;
        padding: 3px;
      }
    }
	
	.item-inline {
  display: inline-block; /* Allows elements to sit side-by-side */
  vertical-align: middle; /* Vertically centers elements relative to each other */
}

.name-highlight {
  font-weight: bold;
  background: rgba(0, 0, 0, 0.15);
}

    .header {
      background: #2c3e50;
      color: white;
      font-weight: bold;
    }

    .row-label {
      font-weight: bold;
      width: clamp(24px, 6vw, 32px) !important;
      min-width: 24px;
      font-size: clamp(0.8rem, 3vw, 0.95rem);
    }

    .digit-bold {
      font-weight: bold;
      color: #006400;
    }

    .quarter-label {
      font-size: clamp(0.55rem, 2vw, 0.65rem);
      color: #006400;
      font-weight: bold;
      display: block;
      margin-top: 2px;
      background: rgba(40, 167, 69, 0.1);
      border-radius: 3px;
      padding: 1px 2px;
      white-space: nowrap;
	  pointer-events: none;
    }


    .pulsate {
      animation: pulsate 2s infinite ease-in-out;
      font-weight: bold;
	  background: #28a745;
	  color: #FFFFFF;
    }

    @keyframes pulsate {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .current-winner-border {
      border: 3.5px solid #28a745 !important;
      box-shadow: 0 0 12px #28a745;
    }

    .corner-label {
      font-size: 0.7em !important;
      line-height: 1.15;
      white-space: pre;
    }

    @media (max-width: 480px) {
      body { padding: 10px 5px; }
      h1 { font-size: 1.35em; margin-bottom: 8px; }
      table { font-size: 0.8em; }
      th, td { padding: 4px 2px; }
      .row-label { width: 22px !important; min-width: 22px; font-size: 0.85em; }
      #controls { flex-direction: column; gap: 8px; }
      #controls input, #controls button { width: 100%; max-width: 340px; }
      #scoreDisplay { font-size: 1.18em; }
      .quarter-label { font-size: 0.58em; padding: 1px 2px; }
      .corner-label { font-size: 0.88em; }
    }
  </style>
</head>
<body>

  <h1>2026 Super Bowl Squares</h1>

<!--
	<div id="controls">
    <input type="text" id="gameId" value="401772987" placeholder="Enter ESPN Game ID">
    <button id="refreshBtn">Refresh Now</button>
  </div>

  <div id="info">Auto-refreshing every 10 seconds</div>
-->
  <div id="scoreDisplay"></div>
  <div id="quarterWinners"></div>
  <div id="status">Loading game data...</div>

  <table id="gridTable"></table>

  <script>
    const DEFAULT_GAME_ID = "401772987";

const gridMap = {
  // Row 2
  "2-1": "DeD", "2-6": "AT",  "2-2": "EL",  "2-5": "CW",  "2-8": "EL",
  "2-7": "RT",  "2-9": "JD",  "2-3": "DP",  "2-4": "TB",  "2-0": "DM",

  // Row 6
  "6-1": "DeD", "6-6": "DM",  "6-2": "DeD", "6-5": "CD",  "6-8": "Reg",
  "6-7": "ES",  "6-9": "JH",  "6-3": "RD",  "6-4": "CS",  "6-0": "TM",

  // Row 7
  "7-1": "ES",  "7-6": "DB",  "7-2": "TB",  "7-5": "EL",  "7-8": "MH",
  "7-7": "StB", "7-9": "SA",  "7-3": "RoD", "7-4": "RB",  "7-0": "CD",

  // Row 8
  "8-1": "RT",  "8-6": "RB",  "8-2": "SB",  "8-5": "RB",  "8-8": "ED",
  "8-7": "RB",  "8-9": "ES",  "8-3": "DeD", "8-4": "RB",  "8-0": "DeD",

  // Row 5
  "5-1": "MT",  "5-6": "RT",  "5-2": "ES",  "5-5": "SB",  "5-8": "GT",
  "5-7": "LD",  "5-9": "RD",  "5-3": "MT",  "5-4": "AD",  "5-0": "BC",

  // Row 3
  "3-1": "ES",  "3-6": "SD",  "3-2": "AT",  "3-5": "DD",  "3-8": "SB",
  "3-7": "LD",  "3-9": "CP",  "3-3": "RoD", "3-4": "TM",  "3-0": "FD",

  // Row 1
  "1-1": "MC",  "1-6": "HW",  "1-2": "RoD", "1-5": "EB",  "1-8": "BC",
  "1-7": "HP",  "1-9": "EL",  "1-3": "DM",  "1-4": "BD",  "1-0": "MH",

  // Row 0
  "0-1": "EB",  "0-6": "EL",  "0-2": "SD",  "0-5": "JD",  "0-8": "CW",
  "0-7": "TM",  "0-9": "MC",  "0-3": "AP",  "0-4": "SB",  "0-0": "LB",

  // Row 4
  "4-1": "SB",  "4-6": "RD",  "4-2": "SC",  "4-5": "JD",  "4-8": "StB",
  "4-7": "CD",  "4-9": "EB",  "4-3": "SC",  "4-4": "RoD", "4-0": "BH",

  // Row 9
  "9-1": "DM",  "9-6": "DM",  "9-2": "RoD", "9-5": "CW",  "9-8": "SA",
  "9-7": "ED",  "9-9": "BH",  "9-3": "RD",  "9-4": "AD",  "9-0": "CD"
};


    const rowOrder = [2, 6, 7, 8, 5, 3, 1, 0, 4, 9];
    const colOrder = [1, 6, 2, 5, 8, 7, 9, 3, 4, 0];

    const table = document.getElementById("gridTable");

    const cornerTh = document.createElement("th");
    cornerTh.className = "header corner-label";
    cornerTh.id = "cornerLabel";
    //cornerTh.innerHTML = "Loading...";

    const colHeaderRow = document.createElement("tr");
    colHeaderRow.appendChild(cornerTh);
    colOrder.forEach(colNum => {
      const th = document.createElement("th");
      th.textContent = colNum;
      th.className = "header";
      colHeaderRow.appendChild(th);
    });
    table.appendChild(colHeaderRow);

    rowOrder.forEach(row => {
      const tr = document.createElement("tr");
      const rowTh = document.createElement("th");
      rowTh.textContent = row;
      rowTh.className = "header row-label";
      tr.appendChild(rowTh);
	  



      colOrder.forEach(col => {
        const key = `${row}-${col}`;
        const td = document.createElement("td");
        const name = gridMap[key] || "(empty)";
		td.textContent = name;
		td.dataset.name = name;
        if (!gridMap[key]) td.className = "empty";
        td.dataset.row = row;
        td.dataset.col = col;
        tr.appendChild(td);
      });

      table.appendChild(tr);
	  	let selectedName = null;

document.querySelectorAll("#gridTable td").forEach(cell => {
  cell.addEventListener("click", () => {
    const name = cell.dataset.name;

    // Clear existing highlights
    document.querySelectorAll("#gridTable td").forEach(c =>
      c.classList.remove("name-highlight")
    );

    // Toggle off if clicking same name
    if (selectedName === name) {
      selectedName = null;
      return;
    }

    selectedName = name;

    // Highlight all matching names
    document.querySelectorAll("#gridTable td").forEach(c => {
      if (c.dataset.name === name) {
        c.classList.add("name-highlight");
      }
    });
  });
});
	  
    });

    function getNameFromSquare(rowDigit, colDigit) {
      const row = parseInt(rowDigit);
      const col = parseInt(colDigit);
      const key = `${row}-${col}`;
      return gridMap[key] || "(empty)";
    }

    async function updateGame() {
      const gameId = document.getElementById("gameId")?.value?.trim() || DEFAULT_GAME_ID;
      document.getElementById("status").textContent = "Refreshing...";

      try {
        //const url = `https://site.api.espn.com/apis/site/v2/sports/football/nfl/summary?event=${gameId}`;
		const url = "https://gist.githubusercontent.com/bhornett/bf63a0c40fa25f91dfd176cad095f06b/raw/5e3011d78745ab42f4f1d210ad740c5e16fac748/data.json"
		
        const res = await fetch(url);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);

        const data = await res.json();
		
		

        const comp = data.header?.competitions?.[0] || {};
		
		const statusType = comp.status?.type || {};
		let activeQuarter = null;

		if (statusType.state.toUpperCase() === "IN" && statusType.shortDetail.toUpperCase()?.startsWith("Q")) {
		  activeQuarter = parseInt(statusType.shortDetail.slice(1), 10);
		}
	
        const competitors = comp.competitors || [];
        const home = competitors.find(c => c.homeAway === "home") || {};
        const away = competitors.find(c => c.homeAway === "away") || {};

        const homeScore = home.score || 0;
        const awayScore = away.score || 0;
        const homeName = home.team?.abbreviation || home.team?.displayName?.slice(0,3).toUpperCase() || "HOME";
        const awayName = away.team?.abbreviation || away.team?.displayName?.slice(0,3).toUpperCase() || "AWAY";
		const homeLogoUrl = home.team?.logos?.[0].href;
		const awayLogoUrl = away.team?.logos?.[0].href;

        document.getElementById("cornerLabel").innerHTML = `${awayName} →<br>↓ ${homeName}`;


        //document.getElementById("scoreDisplay").textContent = 
        //  `${awayName} ${awayScore} –  ${homeScore} ${homeName}`;
		 document.getElementById("scoreDisplay").innerHTML = `<img src="${awayLogoUrl}" width=50 height=50 class="item-inline"><span class="item-inline">${awayName} ${awayScore} –  ${homeScore} ${homeName}</span><img src="${homeLogoUrl}" width=50 height=50 class="item-inline">`;

				document.querySelectorAll("#gridTable td .quarter-label").forEach(el => el.remove());

				const homeQuarters = home.linescores || [];
				const awayQuarters = away.linescores || [];

		 //  let html = "<strong>Quarter Winners:</strong><br>";
		 let html ="";
		  let cumHome = 0, cumAway = 0;

		  const completed = Math.min(homeQuarters.length, awayQuarters.length);

		  for (let q=0; q<completed; q++) {
			const qNum = q+1;

			if (qNum === activeQuarter) {
			  html += `<em>Q${qNum} in progress…</em><br>`;
			  break;
			}

			cumHome += parseInt(home.linescores[q].displayValue||0);
			cumAway += parseInt(away.linescores[q].displayValue||0);

			const r = cumAway % 10;
			const c = cumHome % 10;
			const name = getNameFromSquare(c,r);
			
			
            const awayScoreText = cumAway.toString().slice(0, -1) + `<span class="digit-bold">${r}</span>`;
            const homeScoreText = cumHome.toString().slice(0, -1) + `<span class="digit-bold">${c}</span>`;

            html += `Q${qNum}: ${awayName} ${awayScoreText} – ${homeName} ${homeScoreText} → <strong>${name}</strong><br>`;

			//html += `Q${qNum}: ${name}<br>`;

			document.querySelectorAll("#gridTable td").forEach(cell=>{
			  if (+cell.dataset.row===c && +cell.dataset.col===r) {
				const s=document.createElement("span");
				s.className="quarter-label";
				s.textContent=`Q${qNum} Win`;
				cell.appendChild(s);
			  }
			});
		  }
		  
        document.getElementById("quarterWinners").innerHTML = html;

        document.querySelectorAll(".pulsate, .current-winner-border").forEach(el => {
          el.classList.remove("pulsate", "current-winner-border");
        });


				
				document.querySelectorAll("#gridTable td").forEach(cell => {
		  if (parseInt(cell.dataset.row) === homeScore % 10 && parseInt(cell.dataset.col) === awayScore % 10) {
			cell.classList.add("pulsate", "current-winner-border");
		  }
		});

        const now = new Date().toLocaleTimeString("en-US", {
  hour: "numeric",
  minute: "2-digit",
  second: "2-digit",
  hour12: true
});
        document.getElementById("status").textContent = `Last refresh: ${now}`;

      } catch (err) {
        console.error(err);
        document.getElementById("status").textContent = `Error: ${err.message || "Failed to load"}`;
      }
    }

    updateGame();
    setInterval(updateGame, 30000);
    <!-- document.getElementById("refreshBtn").addEventListener("click", updateGame); -->
  </script>

</body>
</html>